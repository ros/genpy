length = len(data)
# check for buffer protocol support
try:
  tmp = memoryview(data)
  from genpy.generate_struct import memoryview_len
  buff.write(struct.Struct('<I').pack(memoryview_len(tmp)))
  buff.write(tmp)
except TypeError:
  # - if encoded as a list instead, serialize as bytes instead of string
  if type(data) in [list, tuple]:
    buff.write(struct.Struct('<I%sB'%length).pack(length, *data))
  else:
    buff.write(struct.Struct('<I%ss'%length).pack(length, data))